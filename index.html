<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User's Student Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">
<link rel="apple-touch-icon" href="icon-192.png">

</head>
<body>
    <div id="loading-overlay">
        <div class="spinner-container">

            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading UniPortal...</p>
        </div>
    </div>
    
    <div class="dashboard-container main-content-hidden" id="main-app-container">
    
        <aside class="sidebar">
            <div class="logo-area">
                <i class="fas fa-graduation-cap"></i>
                <span>UniPortal</span>
            </div>
            <nav class="sidebar-nav">
                <a href="#overview" class="nav-item active" data-section="overview"><i class="fas fa-chart-line"></i> Dashboard Overview</a>
                <a href="#gpa-calc" class="nav-item" data-section="gpa-calc"><i class="fas fa-calculator"></i> GPA 

Calculator</a>
                <a href="#cgpa-calc" class="nav-item" data-section="cgpa-calc"><i class="fas fa-signal"></i> CGPA Calculator</a>
                <a href="#timetable" class="nav-item" data-section="timetable"><i class="fas fa-calendar-alt"></i> Timetable</a>
                <a href="#notes" class="nav-item" data-section="notes"><i class="fas fa-clipboard"></i> Notes Section</a>
                <a href="#countdown" class="nav-item" data-section="countdown"><i class="fas fa-stopwatch"></i> Exam Countdown</a>
                <a href="#profile" class="nav-item" data-section="profile"><i class="fas fa-user-circle"></i> Profile</a>
            </nav>
           <div class="sidebar-footer">
                    </div>
        </aside>

        <main class="main-content">
            <header class="top-navbar">
                <div class="welcome-display">
                    <h3 id="welcome-user-display">Welcome, Student User</h3>
                    <p>Ready to check your progress?</p>
                </div>
                <div class="user-controls">
                    <div class="notification-container">
                        <i class="fas fa-bell" id="notification-bell"></i>
                        <span class="notification-badge hidden" id="notification-badge">0</span>
                        <div class="notification-dropdown" id="notification-dropdown">
    <div style="padding: 12px 15px; border-bottom: 1px solid var(--color-border); display: flex; justify-content: space-between; align-items: center;">
        <h4 style="margin: 0; font-size: 1rem;">Notifications</h4>
        <button id="clear-notifications-btn" class="btn btn-small btn-secondary" style="padding: 5px 10px; font-size: 0.8rem;">
            <i class="fas fa-trash"></i> Clear
        </button>
    </div>
    <ul id="notification-list"></ul>
    <p class="no-notifications" style="padding: 20px; text-align: center; color: var(--color-text-light);">All caught up!</p>
                        </div>
                    </div>
                    <button id="theme-toggle" class="theme-toggle">
                        <i class="fas fa-sun"></i>
                    </button>
                    
                    <div class="user-info">
                        <span id="user-display-name">User</span>

                        <div class="avatar-upload-container">
                            <input type="file" id="avatar-input-nav" accept="image/*" class="avatar-file-input">
                            <label for="avatar-input-nav">
                                <img id="user-avatar-nav" src="https://via.placeholder.com/40/0077c2/ffffff?text=U" alt="Avatar" class="user-avatar">
                                <i class="fas fa-camera avatar-edit-icon" title="Change Avatar"></i>
                            </label>
                        </div>
                    </div>
                </div>
            </header>

            <section id="overview" class="content-section active">
                <h2>Dashboard Overview</h2>
                <div class="overview-grid">

                    <div class="summary-card total-courses">
                        <i class="fas fa-book-open"></i>
                        <h3>Total Courses</h3>
                        <p id="total-courses-count">0</p>
                    </div>
                    <div class="summary-card current-gpa">
                        <i class="fas fa-chart-line"></i>
                        <h3>Current GPA</h3>
                        <p id="current-gpa-display">N/A</p>
                    </div>
                    <div class="summary-card cumulative-cgpa">
                        <i class="fas fa-trophy"></i>
                        <h3>Cumulative CGPA</h3>
                        <p id="cumulative-cgpa-display">N/A</p>

                    </div>
                    <div class="summary-card upcoming-class">
                        <i class="fas fa-clock"></i>
                        <h3>Upcoming Class</h3>
                        <p id="upcoming-class-display">Nothing Today</p>
                    </div>
                    <div class="summary-card days-to-exam">
                        <i class="fas fa-calendar-day"></i>
                        <h3>Days to Next Exam</h3>
                        <p id="days-to-exam-display">N/A</p>
                    </div>
                </div>
                <div class="quote-card">
                    <p id="motivational-quote">"Discipline is the bridge between goals and success."</p>
                </div>

                <div class="dashboard-chart-card">
                    <h3>GPA Progress</h3>
                    <div class="chart-container">
                        <canvas id="gpa-progress-chart-canvas"></canvas>
                    </div>
                </div>

               <!-- <div class="dashboard-card">
                    <h3>Upcoming Exams</h3>
                    <div id="upcoming-exams-list" class="exam-list">
                        <p class="no-data">No exams scheduled.</p>
                    </div>
                </div> 

                <div class="dashboard-card recent-notes-card">
                    <h3>Recent Notes</h3>
                    <div id="recent-notes-list" class="recent-notes-list">
                        <p class="no-data">No notes saved yet.</p>
                    </div>
                   <!-- <a href="#notes" class="btn btn-secondary btn-full"><i class="fas fa-clipboard"></i> View All Notes</a>
                </div>

                <div class="dashboard-card notifications-card">
                    <h3>Notifications Center</h3>
                    <ul id="notification-list-dashboard" class="notification-list-dashboard">
                        <li class="no-data">No recent alerts.</li>
                    </ul>
                    <a href="#" id="view-notifications-btn" class="btn btn-secondary btn-full"><i class="fas fa-bell"></i> View Notifications</a>
                </div>-->
            </section>
            
            <section id="gpa-calc" class="content-section">
                <h2>GPA Calculator</h2>
                <div class="gpa-calc-grid">
                    <div class="card gpa-table-card">
                        <h3>Current Semester Courses</h3>
                        <div class="table-responsive">
                            <table class="course-table">
                                <thead>
                                    <tr>
                                        <th>Course Code</th>
                                        <th>Units</th>
                                        <th>Grade (A-F)</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="gpa-course-list"></tbody>
                            </table>
                        </div>
                        <button class="btn btn-primary" id="add-course-btn">
                            <i class="fas fa-plus"></i> Add Course
                        </button>
                        <div class="gpa-actions">
                            <button class="btn btn-accent" id="calculate-gpa-btn">Calculate GPA</button>
                            <button class="btn btn-save" id="save-semester-btn">Save Semester</button>
                        </div>
                    </div>
                    <div class="gpa-result-card card">
                        <h3>Semester Result</h3>
                        <p>Numeric GPA: <strong id="gpa-result">N/A</strong></p>
                        <p>Academic Standing: <span id="academic-standing">Pending</span></p>
                        <p class="motivational-feedback" id="gpa-feedback">Enter your courses and grades to begin.</p>
                    </div>
                </div>
            </section>

            <section id="cgpa-calc" class="content-section">
                <h2>CGPA Calculator</h2>
                <div class="cgpa-calc-grid">
                    <div class="card">
                        <h3>Previous Semesters</h3>
                        <div id="cgpa-semester-list">
                            <p class="no-data">No semesters saved yet. Calculate and save a GPA first.</p>
                        </div>
                        <button id="add-manual-sem-btn" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Add Manual Semester
                        </button>
                        <div class="gpa-actions">
                            <button class="btn btn-accent" id="calculate-cgpa-btn">Calculate CGPA</button>
                        </div>
                    </div>
                    <div class="cgpa-result-card card">
                        <h3>Cumulative Result</h3>
                        <div class="progress-circle-container">
                            <div class="progress-circle" id="cgpa-progress-circle">
                                <span class="cgpa-value" id="cgpa-result-display">0.00</span>
                            </div>
                        </div>
                        <p>Total Units: <strong id="cgpa-total-units">0</strong></p>
                        <p>Academic Standing: <span id="cgpa-academic-standing">Pending</span></p>
                    </div>
                </div>
            </section>

            <section id="timetable" class="content-section">
                <h2>Weekly Timetable</h2>
                <div class="timetable-grid">
                    <div class="card timetable-setup-card">
                        <h3>Add New Class</h3>
                        <form id="add-class-form">
                            <div class="form-group">
                                <label for="class-code">Course Code</label>
                                <input type="text" id="class-code" placeholder="e.g., CSC101" required>
                            </div>
                            <div class="form-group">
                                <label for="class-subject">Course Subject</label>
                                <input type="text" id="class-subject" placeholder="e.g., Introduction to Programming" required>
                            </div>
                            <div class="form-group">
                                <label for="class-day">Day</label>
                                <select id="class-day" required>
                                    <option value="" disabled selected>Select Day</option>
                                    <option value="Monday">Monday</option>
                                    <option value="Tuesday">Tuesday</option>
                                    <option value="Wednesday">Wednesday</option>
                                    <option value="Thursday">Thursday</option>
                                    <option value="Friday">Friday</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="class-time">Time</label>
                                <input type="time" id="class-time" required>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Class
                            </button>
                        </form>
                    </div>
                    <div class="card timetable-display-card">
                        <h3>Your Schedule</h3>
                        <div class="table-responsive">
                            <table class="timetable-table">
                                <tbody id="timetable-body">
                                    </tbody>
                            </table>
                        </div>
                        <p class="no-data-timetable" id="no-timetable-data">No classes scheduled. Use the form to add one.</p>
                    </div>
                </div>
            </section>

            <section id="notes" class="content-section">
                <h2>Notes Section</h2>
                <div class="notes-header">
                    <button id="new-note-btn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> New Note
                    </button>
                    <div class="notes-header-actions">
                        <button id="share-note-btn" class="btn btn-secondary">
                            <i class="fas fa-share-alt"></i> Share Note
                        </button>
                        <button id="download-note-btn" class="btn btn-secondary">
                            <i class="fas fa-download"></i> Download Note
                        </button>
                    </div>
                </div>
                
                <div id="notes-grid" class="notes-grid">
                    <p class="no-data">Click "New Note" to start organizing your study materials.</p>
                </div>
            </section>

            <section id="countdown" class="content-section">
                <h2>Exam Countdown</h2>
                <div class="countdown-grid">
                    <div class="card exam-add-card">
                        <h3>Schedule New Exam</h3>
                        <form id="add-exam-form">
                            <div class="form-group">
                                <label for="exam-name">Exam Name</label>
                                <input type="text" id="exam-name" placeholder="e.g., Database Midterm" required>
                            </div>
                            <div class="form-group">
                                <label for="exam-date">Date</label>
                                <input type="date" id="exam-date" required>
                            </div>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Exam
                            </button>
                        </form>
                        <button id="focus-mode-toggle" class="btn btn-accent btn-full" style="margin-top: 20px;">
                            <i class="fas fa-bolt"></i> Activate Focus Mode
                        </button>
                    </div>
                    <div class="card exam-list-card">
                        <h3>All Scheduled Exams</h3>
                        <div id="exam-list-container" class="exam-list-container">
                            <p class="no-data">No upcoming exams scheduled. Focus Mode awaits!</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="profile" class="content-section">
                <h2>Profile & Settings</h2>
                <div class="profile-grid">
                    <div class="card profile-info-card">
                        <div class="avatar-upload-container profile-avatar">
                            <input type="file" id="avatar-input-profile" accept="image/*" class="avatar-file-input">
                            <label for="avatar-input-profile">
                                <img id="profile-avatar-img" src="https://via.placeholder.com/100/0077c2/ffffff?text=U" alt="Profile Avatar" class="user-avatar user-avatar-large">
                                <i class="fas fa-camera avatar-edit-icon" title="Change Avatar"></i>
                            </label>
                        </div>
                        <h3 id="profile-user-name">User's Account</h3>
                        <p><i class="fas fa-envelope"></i> <span id="profile-email-display">user@unistudent.edu</span></p>
                        <p><i class="fas fa-graduation-cap"></i> <span id="profile-major-display">Computer Science</span></p>
                        <p><i class="fas fa-signal"></i> Semester <span id="profile-semester-display">1</span></p>
                    </div>
                    <div class="card profile-update-card">
                        <h3>Update Information</h3>
                        <form id="profile-update-form">
                            <div class="form-group">
                                <label for="full-name">Full Name</label>
                                <input type="text" id="full-name" value="UniPortal User">
                            </div>
                            <div class="form-group">
                                <label for="student-id">Student ID</label>
                                <input type="text" id="student-id" placeholder="Matriculation Number" value="FOS/23/24/******" disabled>
                            </div>
                            <div class="form-group">
                                <label for="major">Major</label>
                                <input type="text" id="major" value="Computer Science">
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" placeholder="user@gmail.com" disabled >
                            </div>
                            <div class="form-group">
                                <label for="current-semester">Current Semester</label>
                                <input type="number" id="current-semester" value="4">
                            </div>
                            <button type="submit" class="btn btn-accent">Save Changes</button>
                        </form>
                    </div>
                    <div class="card backup-card">
                        <h3>Data Backup</h3>
                        <p>Export your data to keep a backup, or import from a previous backup.</p>
                        <div class="backup-actions">
                            <button class="btn btn-primary" id="export-data-btn">
                                <i class="fas fa-download"></i> Export Backup
                            </button>
                            <label for="import-file-input" class="btn btn-accent">
                                <i class="fas fa-upload"></i> Import Backup
                                <input type="file" id="import-file-input" accept=".json">
                            </label>
                        </div>
                    </div>
                </div>
                <div class="card profile-danger-zone">
                    <h3 style="color: var(--color-danger);">Danger Zone</h3>
                    <p>Permanently reset all your saved dashboard data. This cannot be undone.</p>
                    <button class="btn btn-danger" id="reset-data-btn"><i class="fas fa-exclamation-triangle"></i> Reset All Data</button>
                </div>
            </section>
        </main>
    </div>

    <div id="cgpa-manual-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Manual Semester</h2>
                <span class="close-btn" onclick="closeModal('cgpa-manual-modal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="cgpa-manual-form">
                    <div class="form-group">
                        <label for="manual-sem-name">Semester Name</label>
                        <input type="text" id="manual-sem-name" placeholder="e.g., Fall 2023" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-sem-gpa">GPA Achieved</label>
                        <input type="number" id="manual-sem-gpa" step="0.01" min="0" max="5.0" required>
                    </div>
                    <div class="form-group">
                        <label for="manual-sem-units">Total Units</label>
                        <input type="number" id="manual-sem-units" min="1" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Add Semester</button>
                </form>
            </div>
        </div>
    </div>
    
    <div id="note-editor-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="editor-title">Create New Note</h2>
                <span id="close-note-editor-btn" class="close-btn">&times;</span>
            </div>
            <div class="modal-body note-editor-body">
                <input type="text" id="note-title-input" placeholder="Note Title (e.g., 'CSC201 - Week 5')" required>
                <div id="note-editor"></div>
            </div>
            <div class="modal-footer">
                <button id="save-note-btn" class="btn btn-primary"><i class="fas fa-save"></i> Save Note</button>
                <button id="delete-note-btn" class="btn btn-danger" style="display: none;"><i class="fas fa-trash"></i> Delete</button>
                <button id="editor-download-btn" class="btn btn-secondary"><i class="fas fa-download"></i> Download</button>
            </div>
        </div>
    </div>
    
    <div id="shareNotesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Share a Note (Select One)</h2>
                <span class="close-btn" onclick="closeModal('shareNotesModal')">&times;</span>
            </div>
            <div class="modal-body">
                <ul id="noteListContainer" class="share-note-list"></ul>
            </div>
            <div class="modal-footer">
                <button id="closeShareModalBtn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <div id="downloadNotesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Download a Note (Select One)</h2>
                <span class="close-btn" onclick="closeModal('downloadNotesModal')">&times;</span>
            </div>
            <div class="modal-body">
                <ul id="downloadListContainer" class="download-note-list"></ul>
            </div>
            <div class="modal-footer">
                <button id="closeDownloadModalBtn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>

    <div id="confetti-overlay"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

    <script>
    // PWA Service Worker Registration
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', async () => {
            try {
                const registration = await navigator.serviceWorker.register('./sw.js', {
                    scope: './'
                });
                
                console.log('‚úÖ Service Worker registered successfully:', registration.scope);
                
                // Check for updates
                registration.addEventListener('updatefound', () => {
                    const newWorker = registration.installing;
                    console.log('üîÑ Service Worker update found');
                    
                    newWorker.addEventListener('statechange', () => {
                        if (newWorker.state === 'activated') {
                            console.log('‚úÖ New Service Worker activated');
                            // Optional: Show update notification to user
                        }
                    });
                });
                
                // Listen for controller change (new SW activated)
                navigator.serviceWorker.addEventListener('controllerchange', () => {
                    console.log('üîÑ Controller changed, reloading page');
                    window.location.reload();
                });
                
            } catch (error) {
                console.error('‚ùå Service Worker registration failed:', error);
            }
        });
    } else {
        console.warn('‚ö†Ô∏è Service Workers not supported in this browser');
    }
    </script>

    <script src="script.js"></script>
</body>
                                </html>                




